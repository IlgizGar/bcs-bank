{% import "../../../components/icon/icon.njk" as Icon %}

{% macro context( options ) %}
  {% if options.data %}
    {% set options = options.data %}
  {% endif %}

  {% if options.attr %}
    {% set data_array = '' %}
    {% set class_sep = joiner(' ') %}
    {% set data_array %}
      {% for key, value in options.attr -%}
        {{ class_sep() }} data-{{ key }} = "{{ value }}"
      {%- endfor %}
    {% endset %}
  {% endif %}

  <div class="context js-context {% if options.theme %}context_theme-{{ options.theme }}{%  endif %} {{ options.class }}" {{ data_array | safe }}>
    {% if options.items %}
      <select class="context__select" hidden name="{{ options.name }}_select">
        {% for item in options.items %}
          <option value={{ item.val }} {% if item.selected %}selected{% endif %}>{{ item.title }}</option>
        {% endfor %}
      </select>
    {% else %}
      <input type="text" hidden name="{{ options.name }}_input" value="{{ options.title }}">
    {% endif %}
    <button class="context__button">
        <span class="js-context-title">{%  if options.title %}{{ options.title }}{% endif %}</span>
        {{ Icon.icon({'name': 'dropdown'}) }}
    </button>
  </div>
  {#{% if options.block %}#}
    {#{% include "../../" + options.block + ".njk" %}#}
  {#{% endif %}#}
{% endmacro %}
